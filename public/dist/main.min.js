var blackAndWhite=angular.module("blackAndWhite",[]);blackAndWhite.factory("socket",function(){var a=io.connect("http://localhost:3000");return a}),blackAndWhite.controller("makeRoom",function(a,b){a.spinner=!1,a.makeRoomBtn=!0,a.roomMsg="",a.rivalBetting=null,a.winScore=0,a.makeRoom=function(){b.emit("makeRoom",""),a.spinner=!0,a.makeRoomBtn=!1},b.on("makeRoom",function(b){console.log(b.roomNum),a.roomMsg="상대를 기다리고 있습니다.",a.$digest()}),b.on("join_room",function(c){a.spinner=!1,a.makeRoomBtn=!1,a.roomMsg="상대를 기다리고 있습니다."===a.roomMsg?"상대방이 입장하셨습니다. 게임을 시작합니다.":"입장하셨습니다. 게임을 시작합니다.",a.$digest(),setTimeout(function(){a.roomMsg="",$("#room_modal").css("width","100%").css("height","100%").css("margin-top",0),a.gameui=!0,a.init(),a.$digest(),b.emit("gameStart",c)},2e3)}),b.on("isTurn",function(b){console.log("내턴!"),a.myTurn=!0,1===b&&(a.msg="첫번째 순서 입니다. 배팅해주세요."),a.$digest()}),b.on("noTurn",function(b){console.log("내턴 아니다!"),a.myTurn=!1,1===b&&(a.msg="상대방의 배팅을 기다리고 있습니다."),a.$digest()}),b.on("getBetting",function(b){console.log(b),a.rivalBetting=b,a.blackAndWhite_box(b)}),b.on("gameLost",function(){a.msg="패배하셨습니다 ㅠ"}),b.on("gameWin",function(){a.msg="승리하셨습니다!. 축하드려요~"}),b.on("meWin",function(){a.msg="승리하셨습니다. 상대방의 순서입니다.",a.winScore++,a.$digest(),5==a.winScore&&b.emit("gameEnd",[])}),b.on("meLose",function(){a.msg="패배하셨습니다. 먼저 배팅해주세요.",a.$digest()}),a.betting=function(){if(!a.myTurn)return alert("저의 턴이 아니에요 ㅠ 기다려주세용!"),!1;if(a.bettingScore>a.score)return alert("가지고 있는 점수보다 배팅점수가 큽니다."),!1;if(a.score=a.score-a.bettingScore,null!==a.rivalBetting){if(console.log("내점수 : "+a.bettingScore),console.log("상대점수 : "+a.rivalBetting),1*a.bettingScore>1*a.rivalBetting){if(5===a.myScore)return void alert("승리하셨습니다.");b.emit("meWin")}else b.emit("meLose");a.rivalBetting=null,a.bettingScore=null}else a.msg="배팅하였습니다. 상대방이 맞배팅 할때까지 기다려주세요.",b.emit("betting",{bettingScore:a.bettingScore})},a.init=function(){a.score=99},a.blackAndWhite_box=function(b){var c="";9>=b?(a.box_black=!0,c="검은색"):(a.box_black=!1,c="흰색"),a.msg="상대방이 배팅했습니다. 상대방의 색은 "+c+"입니다.",a.$digest()}}),blackAndWhite.controller("roomList",["socket"],function(a,b){a.roomList=[],b.on("room_update",function(b){for(room_name in b)room_name.indexOf("room_")>-1&&-1===a.roomList.indexOf(room_name)&&a.roomList.push(room_name);a.$digest()}),b.on("roomListUpdate",function(a){console.log("roomList"),console.log(a);var b=0;console.log(angular),$.each(a,function(){0===b?b++:angular.element(document.getElementById("rooms_list")).append("<room></room>")})})}),blackAndWhite.controller("gameCore",function(){});